---
name: address-pr-comments
description: Guide for addressing PR review comments iteratively. Use this when asked to address, fix, or resolve comments on a pull request (Azure DevOps or GitHub).
---

To address PR review comments, follow this process:

## Phase 1: Fetch PR Comments

Use the appropriate tool based on the PR platform:

- **Azure DevOps PRs**: Use ADO MCP tools
  - `ado-repo_list_pull_request_threads` to get comment threads
  - `ado-repo_list_pull_request_thread_comments` for thread details
- **GitHub PRs**: Use GitHub MCP tools
  - `github-mcp-server-pull_request_read` with method `get_review_comments`

## Phase 2: Process Each Comment

For each active comment in the PR:

1. **Mark the comment as pending** - Set the thread status to "Pending" to indicate it is being processed
   - **Azure DevOps PRs**: Use `ado-repo_update_pull_request_thread` with status "Pending"
2. **Read the comment** - Understand what change is being requested
3. **Address the comment** - Make the necessary code/documentation changes
   - If anything is unclear, ambiguous, or you get stuck, reply to that specific comment asking for clarification from the reviewer before proceeding
4. **Build and run unit tests** - Verify the change doesn't break anything
   - Build the affected module's unit tests
   - Run the tests and ensure they pass
5. **Commit locally** - Create a focused commit for this specific change
   - Use a descriptive commit message that references the comment

## Phase 3: Finalize

After all comments have been addressed:

1. **Ask for approval** - Confirm with the user that all comments have been addressed satisfactorily
2. **Push changes** - Push all local commits to the remote branch using `git push`
3. **Reply to comments and mark as resolved/fixed**:
   - **Azure DevOps PRs**: Use ADO MCP tools
     - `ado-repo_reply_to_comment` to reply to each thread
     - `ado-repo_update_pull_request_thread` with status "Fixed" or "Resolved" (NEVER use "Closed" - the human reviewer who made the comment is expected to mark comments "Closed" after reviewing the changes)
   - **GitHub PRs**: Use GitHub CLI
     - `gh pr review` or `gh api` to reply to review comments
   - **On failure**: If updating a thread fails (e.g., `Error updating pull request thread`), retry the operation. If it continues to fail, track it for the summary.
4. **Summarize results** - Provide a summary to the user including:
   - List of all comments that were addressed
   - Any comments that failed to update (with thread IDs) so the user can manually resolve them
   - Any comments that were skipped or need clarification

## Key Principles

- Address comments one at a time to keep changes focused and reviewable
- Always build and test after each change to catch issues early
- Commit after each comment to maintain clear history
- Wait for user approval before pushing to allow for review of changes
- Ask the user if they would like you to reply to comments. If yes, reply with specific details about how they were addressed
- Use the correct platform tools (ADO MCP for Azure DevOps, GitHub MCP/CLI for GitHub)

## AI Reply Format

When posting replies to PR comments, prefix each reply with **"ðŸ¤– MrBot:"** to clearly indicate the response was generated by AI. This helps reviewers distinguish AI-generated replies from human responses.

Example reply format:
```
ðŸ¤– MrBot: Fixed by updating the null check before accessing the pointer. See commit abc1234.
```
